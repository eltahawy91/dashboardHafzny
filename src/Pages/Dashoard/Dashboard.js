import { React, useState } from "react";
import Sidebar from "../../Component/Sidebar/Sidebar";
import ContentDashboard from "../../Component/ChartComponent/Chart";
import Header from "../../Component/Header/Header";
import { fetchDataWithRetries } from "../../Component/function/FunctionApi";
import { useEffect } from "react";
import "./Dashboard.css";

function DashBoard() {
    const [dataTeacher, setDataTeacher] = useState("");
    const [dataStudent, setDataStudent] = useState("");
    const [dataAdmins, setDataAdmins] = useState("");


    useEffect(() => {
        const login = localStorage.getItem("login");
        if (login === null) {
            window.location.href = '/Dashboard';
        }
        }, []);

    useEffect(() => {
        fetchDataWithRetries("teachers", setDataTeacher);
        fetchDataWithRetries("students", setDataStudent);
        fetchDataWithRetries("admins", setDataAdmins);
    }, []);

    return (
        <div className="apDiv dashBoard">
            <Sidebar />
            <div className="body_container container" dir="rtl">
                <div className="Header">
                    <Header isHide="true" title="لوحة التحكم" />
                </div>
                <div className="numberUsers">
                    <div className="firstContent">
                        <div className="numberTeacher">
                            <div>
                                <p>عدد المعلمون</p>
                                {dataTeacher && <h5>{dataTeacher.teachers.length}</h5>}
                            </div>
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="50"
                                height="50"
                                viewBox="0 0 32 32"
                                fill="none"
                            >
                                <g clip-path="url(#clip0_998_1576)">
                                    <path
                                        d="M6.00001 28C5.99909 27.6908 5.90247 27.3894 5.72342 27.1373C5.54437 26.8852 5.29167 26.6947 5.00001 26.592V25C5.00001 24.8674 4.94733 24.7402 4.85356 24.6464C4.7598 24.5527 4.63262 24.5 4.50001 24.5H1.50001C1.1466 24.4993 0.804351 24.6238 0.533889 24.8513C0.263427 25.0787 0.0822035 25.3946 0.0223165 25.7429C-0.0375705 26.0912 0.0277436 26.4495 0.206691 26.7542C0.385638 27.059 0.666669 27.2906 1.00001 27.408V28.592C0.666669 28.7094 0.385638 28.941 0.206691 29.2458C0.0277436 29.5505 -0.0375705 29.9088 0.0223165 30.2571C0.0822035 30.6054 0.263427 30.9213 0.533889 31.1488C0.804351 31.3762 1.1466 31.5007 1.50001 31.5H4.50001C4.63262 31.5 4.7598 31.4473 4.85356 31.3536C4.94733 31.2598 5.00001 31.1326 5.00001 31V29.408C5.29167 29.3053 5.54437 29.1148 5.72342 28.8627C5.90247 28.6106 5.99909 28.3092 6.00001 28ZM1.50001 25.5H4.00001V26.5H1.50001C1.3674 26.5 1.24022 26.4473 1.14646 26.3536C1.05269 26.2598 1.00001 26.1326 1.00001 26C1.00001 25.8674 1.05269 25.7402 1.14646 25.6464C1.24022 25.5527 1.3674 25.5 1.50001 25.5ZM4.00001 30.5H1.50001C1.3674 30.5 1.24022 30.4473 1.14646 30.3536C1.05269 30.2598 1.00001 30.1326 1.00001 30C1.00001 29.8674 1.05269 29.7402 1.14646 29.6464C1.24022 29.5527 1.3674 29.5 1.50001 29.5H4.00001V30.5ZM4.50001 28.5H2.00001V27.5H4.50001C4.63262 27.5 4.7598 27.5527 4.85356 27.6464C4.94733 27.7402 5.00001 27.8674 5.00001 28C5.00001 28.1326 4.94733 28.2598 4.85356 28.3536C4.7598 28.4473 4.63262 28.5 4.50001 28.5Z"
                                        fill="#017457"
                                    />
                                    <path
                                        d="M31.4745 12.5775L31.245 4.211C31.2358 3.88691 31.1006 3.57918 30.8681 3.3532C30.6357 3.12721 30.3242 3.00079 30 3.00079C29.6758 3.00079 29.3643 3.12721 29.1319 3.3532C28.8994 3.57918 28.7642 3.88691 28.755 4.211L28.509 13.068L24.169 18.986L20.825 16.1205C20.781 16.0822 20.7305 16.0521 20.676 16.0315L16.7175 14.5475L14.5 13.217V11.6175C14.9036 11.2934 15.241 10.8944 15.4935 10.4425C15.6596 10.4807 15.8295 10.5 16 10.5C16.4966 10.5303 16.9851 10.3635 17.3595 10.0359C17.7339 9.70825 17.9641 9.24622 18 8.75V4.5C17.9987 3.43954 17.5768 2.42289 16.827 1.67303C16.0771 0.923175 15.0605 0.501323 14 0.5H10C9.54963 0.500572 9.11257 0.652835 8.75934 0.932231C8.4061 1.21163 8.15728 1.60186 8.053 2.04C7.47723 2.14543 6.95658 2.44924 6.58153 2.89865C6.20647 3.34805 6.00071 3.91465 6 4.5V8.75C6.03593 9.24622 6.26607 9.70825 6.64049 10.0359C7.01491 10.3635 7.50341 10.5303 8 10.5C8.17046 10.5 8.34037 10.4807 8.5065 10.4425C8.75904 10.8944 9.09637 11.2934 9.5 11.6175V13.217L7.2825 14.547L5.2715 15.302C4.60561 15.554 4.03192 16.0022 3.62631 16.5874C3.22071 17.1725 3.00231 17.867 3 18.579V23C3 23.1326 3.05268 23.2598 3.14645 23.3536C3.24021 23.4473 3.36739 23.5 3.5 23.5C3.63261 23.5 3.75979 23.4473 3.85355 23.3536C3.94732 23.2598 4 23.1326 4 23V18.579C4.00163 18.0705 4.15763 17.5744 4.44735 17.1565C4.73707 16.7386 5.14686 16.4184 5.6225 16.2385L7 15.7215V30.5H6.5C6.36739 30.5 6.24021 30.5527 6.14645 30.6464C6.05268 30.7402 6 30.8674 6 31C6 31.1326 6.05268 31.2598 6.14645 31.3536C6.24021 31.4473 6.36739 31.5 6.5 31.5H20.5C20.6326 31.5 20.7598 31.4473 20.8536 31.3536C20.9473 31.2598 21 31.1326 21 31V24.2555L24.754 25.8505C24.8659 25.898 24.9912 25.9032 25.1066 25.865C25.222 25.8268 25.3196 25.7479 25.381 25.643L31.751 14.764C31.952 14.4199 32.0339 14.0192 31.9839 13.6238C31.9339 13.2285 31.7548 12.8607 31.4745 12.5775ZM30 4C30.0639 3.99972 30.1254 4.02456 30.1713 4.06916C30.2171 4.11376 30.2436 4.17457 30.245 4.2385L30.4595 12.0625C30.1485 12.0064 29.8281 12.0393 29.535 12.1575L29.755 4.2385C29.7564 4.17457 29.7829 4.11376 29.8287 4.06916C29.8746 4.02456 29.9361 3.99972 30 4ZM11.45 18.5H12.55L13.473 27.27L12 28.375L10.527 27.27L11.45 18.5ZM12.699 17.5H11.301L10.901 16.7425L12 16.083L13.099 16.743L12.699 17.5ZM12.806 15.4005L14.0775 14.1295L15.694 15.0995L14.4225 16.3705L12.806 15.4005ZM9 8.5V6.451C9.62034 6.36312 10.1962 6.07871 10.643 5.6395C12.024 6.21138 13.5053 6.50156 15 6.493V8.5C15 9.29565 14.6839 10.0587 14.1213 10.6213C13.5587 11.1839 12.7956 11.5 12 11.5C11.2044 11.5 10.4413 11.1839 9.87868 10.6213C9.31607 10.0587 9 9.29565 9 8.5ZM16 9.5C15.9571 9.49754 15.9144 9.49286 15.872 9.486C15.9557 9.16397 15.9987 8.83272 16 8.5V8C16.542 8 17 8.3435 17 8.75C17 9.1565 16.542 9.5 16 9.5ZM8.5 3C8.63261 3 8.75979 2.94732 8.85355 2.85355C8.94732 2.75979 9 2.63261 9 2.5C9.00026 2.23486 9.10571 1.98066 9.29319 1.79319C9.48066 1.60571 9.73486 1.50026 10 1.5H14C14.7954 1.50093 15.5579 1.81729 16.1203 2.3797C16.6827 2.94211 16.9991 3.70463 17 4.5V7.2435C16.6907 7.08417 16.3479 7.00071 16 7V6C16 5.86739 15.9473 5.74021 15.8536 5.64645C15.7598 5.55268 15.6326 5.5 15.5 5.5C12.231 5.5 10.7885 4.5915 10.7775 4.584C10.7208 4.54621 10.6569 4.52042 10.5899 4.50821C10.5228 4.496 10.454 4.49762 10.3876 4.51298C10.3212 4.52834 10.2586 4.55711 10.2038 4.59752C10.1489 4.63794 10.1029 4.68915 10.0685 4.748C9.6395 5.483 8.5095 5.5 8.5 5.5C8.36739 5.5 8.24021 5.55268 8.14645 5.64645C8.05268 5.74021 8 5.86739 8 6V7C7.65207 7.00071 7.3093 7.08417 7 7.2435V4.5C7.0004 4.1023 7.15856 3.721 7.43978 3.43978C7.721 3.15856 8.1023 3.0004 8.5 3ZM8 9.5C7.458 9.5 7 9.1565 7 8.75C7 8.3435 7.458 8 8 8V8.5C8.0013 8.83272 8.0443 9.16397 8.128 9.486C8.0856 9.49286 8.04288 9.49754 8 9.5ZM12 12.5C12.5143 12.4998 13.0238 12.3998 13.5 12.2055V13.293L12 14.793L10.5 13.293V12.205C10.9762 12.3995 11.4856 12.4996 12 12.5ZM9.9225 14.13L11.194 15.4005L9.5775 16.3705L8.306 15.0995L9.9225 14.13ZM8 16.2065L9.1465 17.353C9.22538 17.4319 9.32838 17.4821 9.43909 17.4957C9.5498 17.5093 9.66188 17.4854 9.7575 17.428L10.0425 17.257L10.487 18.0985L9.503 27.4475C9.49383 27.5335 9.50717 27.6203 9.5417 27.6996C9.57624 27.7788 9.63079 27.8477 9.7 27.8995L11.7 29.3995C11.7865 29.4646 11.8918 29.4998 12 29.4998C12.1082 29.4998 12.2135 29.4646 12.3 29.3995L14.3 27.8995C14.3692 27.8477 14.4238 27.7788 14.4583 27.6996C14.4928 27.6203 14.5062 27.5335 14.497 27.4475L13.513 18.0985L13.958 17.257L14.243 17.428C14.3386 17.4853 14.4505 17.5091 14.5611 17.4955C14.6718 17.4819 14.7747 17.4317 14.8535 17.353L16 16.207V30.5H8V16.2065ZM24.74 24.7575L21 23.17V21C21 20.8674 20.9473 20.7402 20.8536 20.6464C20.7598 20.5527 20.6326 20.5 20.5 20.5C20.3674 20.5 20.2402 20.5527 20.1464 20.6464C20.0527 20.7402 20 20.8674 20 21V30.5H17V15.7215L20.2415 16.9375L23.5755 19.795L23.093 20.4525C23.0146 20.5595 22.9818 20.6933 23.0021 20.8244C23.0223 20.9556 23.0937 21.0733 23.2008 21.1518C23.3078 21.2302 23.4416 21.2629 23.5727 21.2427C23.7038 21.2225 23.8216 21.151 23.9 21.044L28.2425 15.1225L29.7295 16.2375L24.74 24.7575ZM30.888 14.2585L30.238 15.3685L28.834 14.3155L29.5305 13.3655C29.6539 13.1973 29.8371 13.0829 30.0424 13.046C30.2477 13.0091 30.4593 13.0524 30.6335 13.167C30.8078 13.2816 30.9314 13.4588 30.9787 13.6619C31.0261 13.8651 30.9936 14.0786 30.888 14.2585Z"
                                        fill="#017457"
                                    />
                                </g>
                                <defs>
                                    <clipPath id="clip0_998_1576">
                                        <rect width="50" height="50" fill="#017457" />
                                    </clipPath>
                                </defs>
                            </svg>
                        </div>
                    </div>
                    <div className="firstContent">
                        <div className="numberTeacher">
                            <div>
                                <p>عدد الطلاب</p>
                                {dataStudent && <h5>{dataStudent.students.length}</h5>}
                            </div>
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="50"
                                height="50"
                                viewBox="0 0 32 32"
                                fill="none"
                            >
                                <g clip-path="url(#clip0_998_1581)">
                                    <path
                                        d="M25.7948 21.1361V17.8048L24.3889 18.3518L24.3848 18.3425L24.3513 18.2817C23.8126 17.4429 22.9414 16.8594 21.9604 16.6815L18.5776 16.066V15.7989C19.8426 15.0643 20.769 13.8111 21.0577 12.3295C21.9949 12.1357 22.7017 11.3042 22.7017 10.3103V5.21855C22.7025 4.52166 22.478 3.84318 22.0619 3.28422C21.6457 2.72526 21.06 2.31574 20.3922 2.1167L20.1344 1.85894C18.9353 0.659858 17.3414 0 15.6458 0C12.146 0 9.29832 2.84718 9.29832 6.34752V10.3103C9.29832 11.3042 10.0051 12.1357 10.9423 12.3295C11.2315 13.8111 12.1574 15.0649 13.4224 15.7989V16.066L10.0401 16.681C9.06015 16.8588 8.18945 17.4414 7.65022 18.2796L7.61929 18.3549L6.20523 17.8048V21.1361C5.35257 21.1361 4.65869 21.8299 4.65869 22.6826V24.7447C4.65869 25.5973 5.35257 26.2912 6.20523 26.2912V28.1904L16 32L25.7948 28.1904V26.2912C26.6474 26.2912 27.3413 25.5973 27.3413 24.7447V22.6826C27.3413 21.8299 26.6474 21.1361 25.7948 21.1361ZM19.5436 17.2898L21.7758 17.6955C22.4331 17.8151 23.0151 18.1945 23.4033 18.7348L18.4157 20.6742L19.5436 17.2898ZM14.4973 16.2717C14.9731 16.417 15.4773 16.4964 16 16.4964C16.5227 16.4964 17.0269 16.417 17.5027 16.2717L16 17.3986L14.4973 16.2717ZM15.2154 18.0987L14.1632 19.1503L13.4807 17.1032L13.8091 17.0439L15.2154 18.0987ZM18.1909 17.0444L18.5193 17.1037L17.8368 19.1508L16.7846 18.0992L18.1909 17.0444ZM21.1551 11.198V9.42256C21.4619 9.60144 21.6706 9.93034 21.6706 10.3103C21.6706 10.6902 21.4619 11.0191 21.1551 11.198ZM10.8449 11.198C10.5381 11.0191 10.3293 10.6902 10.3293 10.3103C10.3293 9.93034 10.5381 9.60144 10.8449 9.42256V11.198ZM10.8449 7.73271V8.32142C10.6641 8.36867 10.4906 8.44048 10.3293 8.53485V6.34752C10.3293 3.41631 12.7141 1.03103 15.6458 1.03103C17.0656 1.03103 18.4013 1.58417 19.4055 2.58839L19.8602 3.04359L19.9988 3.07762C20.4766 3.19636 20.9009 3.47173 21.2039 3.85978C21.507 4.24783 21.6713 4.7262 21.6706 5.21855V8.53485C21.5095 8.44027 21.336 8.36845 21.1551 8.32142V7.73271H19.5204C18.1234 7.73271 16.7882 7.06563 15.9505 5.94851L15.5407 5.40104L14.5163 6.42588C13.673 7.26874 12.5522 7.73271 11.3604 7.73271H10.8449ZM11.8759 11.3413V8.74002C13.1487 8.62197 14.3297 8.06985 15.2453 7.15481L15.4458 6.95428C16.4794 8.09511 17.9682 8.76373 19.5204 8.76373H20.1241V11.3413C20.1241 13.6152 18.2739 15.4654 16 15.4654C13.7261 15.4654 11.8759 13.6152 11.8759 11.3413ZM10.2242 17.6955L12.4564 17.2898L13.5843 20.6742L8.59567 18.7343C8.98385 18.1935 9.5669 17.8151 10.2242 17.6955ZM5.68972 24.7447V22.6826C5.68972 22.398 5.92118 22.1671 6.20523 22.1671C7.05789 22.1671 7.75177 22.861 7.75177 23.7136C7.75177 24.5663 7.05789 25.2602 6.20523 25.2602C5.92118 25.2602 5.68972 25.0292 5.68972 24.7447ZM15.4845 30.6927L7.23626 27.4856V26.0726C8.14511 25.6736 8.7828 24.7679 8.7828 23.7136C8.7828 22.6594 8.14511 21.7536 7.23626 21.3546V19.3122L15.4845 22.5197V30.6927ZM13.9539 20.8185L16 18.7719L18.0461 20.818L16 21.6139L13.9539 20.8185ZM24.7637 27.4851L16.5155 30.6921V22.5197L24.7637 19.3122V21.3546C23.8549 21.7536 23.2172 22.6594 23.2172 23.7136C23.2172 24.7679 23.8549 25.6736 24.7637 26.0726V27.4851ZM26.3103 24.7447C26.3103 25.0292 26.0788 25.2602 25.7948 25.2602C24.9421 25.2602 24.2482 24.5663 24.2482 23.7136C24.2482 22.861 24.9421 22.1671 25.7948 22.1671C26.0788 22.1671 26.3103 22.398 26.3103 22.6826V24.7447Z"
                                        fill="#017457"
                                    />
                                </g>
                                <defs>
                                    <clipPath id="clip0_998_1581">
                                        <rect width="50" height="50" fill="#017457" />
                                    </clipPath>
                                </defs>
                            </svg>
                        </div>
                    </div>
                    <div className="firstContent">
                        <div className="numberTeacher">
                            <div>
                                <p>عدد الادمن</p>
                                {dataAdmins && <h5>{dataAdmins.admins.length}</h5>}
                            </div>
                            <i className="fa-thin fa-user-tie-hair"></i>
                        </div>
                    </div>
                </div>
                <ContentDashboard />
            </div>
        </div>
    );
}

export default DashBoard;
